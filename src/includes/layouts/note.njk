---
layout: base
---
{% set absolutePostUrl %}{{ page.url | url | absoluteUrl(site.url) }}{% endset %}
{% set mentionCount = webmentions.children | webmentionCountByType(absolutePostUrl, "in-reply-to", "mention-of") %}
{% set likeCount = webmentions.children | webmentionCountByType(absolutePostUrl, "like-of") %}
{% set repostCount = webmentions.children | webmentionCountByType(absolutePostUrl, "repost-of") %}

<div class="note note--detail h-entry">
    <div class="note__meta">
        <a class="note__author u-author" href="{{ site.url }}">
            <img class="note__author__photo u-photo" src="{{ author.avatar | url }}" alt="">
            <strong class="note__author__name">{{ author.name }}</strong>
        </a>
        <span class="note__meta__divider">&sdot;</span>
        <time class="note__date dt-published" datetime="{{ page.date | iso }}">
            {{ page.date | readableDate }}
        </time>
    </div>
    <div class="note__content">
        <div class="p-name p-content markdown">
            {{ content | safe }}
        </div>
    </div>
    <ul class="note__stats">
        <li class="note__stats__item note__stats__item--mentions" title="{{ mentionCount }} mentions">
            {% icon "message" %}{{ mentionCount }}
        </li>
        <li class="note__stats__item note__stats__item--reposts" title="{{ repostCount }} reposts">
            {% icon "repost" %}{{ repostCount }}
        </li>
        <li class="note__stats__item note__stats__item--likes" title="{{ likeCount }} likes">
            {% icon "heart" %}{{ likeCount }}
        </li>
    </ul>
    {% if mentionCount != "0" %}
        <div class="note__webmentions">
            {% include 'webmentions.njk' %}       
        </div>
    {% endif %}
</div>